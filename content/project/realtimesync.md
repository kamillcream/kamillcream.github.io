# 실시간 동기화 협업 툴 구현

## 문제 1

---

### 상황
- 구글 닥스(Google Docs), 노션(Notion)과 같은 실시간 동기화가 가능한 협업 툴을 개발하려고 한다.
- 이런 서비스는 여러 사용자가 동시에 문서를 편집하고, 변경 사항을 실시간으로 반영해야 한다.

---

- 고민 : 실시간 통신을 Rest API로 구현할지, 웹소켓으로 구현할지.
- 실시간 동기화가 핵심 기능이기 때문에 웹소켓을 사용하는 것이 낫겠다고 생각했으나 구글 닥스는 Rest API를 이용.

---

### 의문 : 웹소켓을 Rest API 대신 사용하는 이유는 실시간 통신과 서버 부하 감소 목적인데 왜 실시간 동기화 기능에 Rest API로 요청을 보내는지?

#### ✅ WebSocket의 서버 부하 문제
- 웹소켓은 한 번 연결되면 에러가 발생하거나 명시적으로 종료하지 않는 한 계속 유지된다.
즉, 수천~수만 개의 연결이 계속 열려 있다면 서버 부하가 급격히 증가할 수 있다.
반면 REST API는 필요할 때만 요청을 보내므로 서버 부하를 좀 더 안정적으로 관리할 수 있다.
#### ✅ 데이터 일관성 문제 해결
- 웹소켓은 서버가 클라이언트에게 변경 사항을 즉시 전송하는 방식.
- 그러나 동일한 문서를 여러 사용자가 편집하는 경우, 충돌(Merge Conflict)이 발생할 수 있음.
- REST API 방식은 서버가 변경 사항을 일괄적으로 처리하여 데이터 일관성을 유지하기 쉬움.
---

### 그럼에도 웹소켓을 사용하는 이유
#### 1️⃣ 문서 변경 사항을 즉시 반영해야 함
- REST API 방식은 변경 사항을 주기적으로 반영하는 형태(예: 5초마다 저장).
- 하지만 실시간 편집에서는 딜레이 없이 반영이 되어야 함.
- 따라서 웹소켓을 통해 실시간 변경 사항을 전파하는 것이 필요함.
#### 2️⃣ 다수의 사용자가 동일한 문서를 조회하는 경우
- 여러 사용자가 GET 요청을 통해 문서 정보를 불러온다고 가정.
- REST API 방식에서는 각각의 사용자마다 동일한 문서 데이터를 처리해야 함.
- 웹소켓 + Redis pub/sub을 사용하면 동일한 문서를 여러 번 조회할 필요 없이,
  변경 사항을 한 번만 처리한 후 모든 클라이언트에 전파 가능.

---
### REST API + WebSocket 혼합
#### REST API가 요청을 받아 불필요한 소켓 연결 방지 및 데이터의 일관성을 보장하고 웹소켓으로 응답함으로써 실시간 반영과 동일한 조회 로직을 한 번만 수행하여 워크로드 감소의 효과를 기대하고 있음.